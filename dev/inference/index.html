<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Inference · Jaynes.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="Jaynes.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit">Jaynes.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><a class="tocitem" href="../concepts/">Concepts</a></li><li><a class="tocitem" href="../modeling_lang/">Modeling language</a></li><li><a class="tocitem" href="../examples/">Examples</a></li><li><a class="tocitem" href="../architecture/">Architecture</a></li><li><span class="tocitem">Library</span><ul><li><a class="tocitem" href="../sites/">Traces, choices, and call sites</a></li><li><a class="tocitem" href="../contexts/">Execution contexts</a></li><li><a class="tocitem" href="../selection_interface/">Selection interface</a></li><li class="is-active"><a class="tocitem" href>Inference</a><ul class="internal"><li><a class="tocitem" href="#Importance-sampling"><span>Importance sampling</span></a></li><li><a class="tocitem" href="#Particle-filtering"><span>Particle filtering</span></a></li><li><a class="tocitem" href="#Markov-chain-Monte-Carlo"><span>Markov chain Monte Carlo</span></a></li></ul></li><li><a class="tocitem" href="../fmi/">Foreign model interface</a></li><li><a class="tocitem" href="../diff_prog/">Differentiable programming</a></li></ul></li><li><a class="tocitem" href="../related_work/">Related work</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Library</a></li><li class="is-active"><a href>Inference</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Inference</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/femtomc/Jaynes.jl/blob/master/docs/src/inference.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h2 id="Importance-sampling"><a class="docs-heading-anchor" href="#Importance-sampling">Importance sampling</a><a id="Importance-sampling-1"></a><a class="docs-heading-anchor-permalink" href="#Importance-sampling" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="Jaynes.importance_sampling" href="#Jaynes.importance_sampling"><code>Jaynes.importance_sampling</code></a> — <span class="docstring-category">Function</span></header><section><div><p>Samples from the model prior.</p><pre><code class="language-julia">particles, normalized_weights = importance_sampling(model::Function, 
                                                    args::Tuple; 
                                                    observations::ConstrainedSelection = ConstrainedAnywhereSelection(), 
                                                    num_samples::Int = 5000)</code></pre><p>Samples from a programmer-provided proposal function.</p><pre><code class="language-julia">particles, normalized_weights = importance_sampling(model::Function, 
                                                    args::Tuple, 
                                                    proposal::Function, 
                                                    proposal_args::Tuple; 
                                                    observations::ConstrainedSelection = ConstrainedAnywhereSelection(), 
                                                    num_samples::Int = 5000)</code></pre><p>Run importance sampling on the posterior over unconstrained addresses and values. Returns an instance of <code>Particles</code> and normalized weights.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/femtomc/Jaynes.jl/blob/8c758de3c8d97da8d23c39f73e5b05028a1b3b5a/src/inference/is.jl#L40-L59">source</a></section></article><div class="admonition is-info"><header class="admonition-header">Info</header><div class="admonition-body"><p>Addressed randomness in a custom proposal passed to <code>importance_sampling</code> should satisfy the following criteria to ensure that inference is mathematically valid:</p><ol><li>Custom proposals should only propose to unobserved addresses in the original program.</li><li>Custom proposals should not propose to addresses which do not occur in the original program.</li></ol></div></div><h2 id="Particle-filtering"><a class="docs-heading-anchor" href="#Particle-filtering">Particle filtering</a><a id="Particle-filtering-1"></a><a class="docs-heading-anchor-permalink" href="#Particle-filtering" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="Jaynes.initialize_filter" href="#Jaynes.initialize_filter"><code>Jaynes.initialize_filter</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">particles = initialize_filter(fn::Function, 
                              args::Tuple,
                              observations::ConstrainedHierarchicalSelection,
                              num_particles::Int)</code></pre><p>Instantiate a set of particles using a call to <code>importance_sampling</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/femtomc/Jaynes.jl/blob/8c758de3c8d97da8d23c39f73e5b05028a1b3b5a/src/inference/pf.jl#L76-L84">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Jaynes.filter_step!" href="#Jaynes.filter_step!"><code>Jaynes.filter_step!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">filter_step!(ps::Particles,
             new_args::Tuple,
             observations::ConstrainedHierarchicalSelection)</code></pre><p>Perform a single filter step from an instance <code>ps</code> of <code>Particles</code>, applying the constraints specified by <code>observations</code>.</p><pre><code class="language-julia">filter_step!(ps::Particles,
             new_args::Tuple,
             proposal::Function,
             proposal_args::Tuple,
             observations::ConstrainedHierarchicalSelection)</code></pre><p>Perform a single filter step using a custom proposal function, applying the constraints specified by <code>observations</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/femtomc/Jaynes.jl/blob/8c758de3c8d97da8d23c39f73e5b05028a1b3b5a/src/inference/pf.jl#L87-L103">source</a></section></article><div class="admonition is-info"><header class="admonition-header">Info</header><div class="admonition-body"><p>Custom proposals provided to <code>filter_step!</code> should accept <em>as first argument</em> a <code>CallSite</code> instance (e.g. so that you can use the previous trace and information in your transition proposal).</p></div></div><article class="docstring"><header><a class="docstring-binding" id="Jaynes.resample!" href="#Jaynes.resample!"><code>Jaynes.resample!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">resample!(ps::Particles)
resample!(ps::Particles, num::Int)</code></pre><p>Resample from an existing instance of <code>Particles</code> by mutation in place.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/femtomc/Jaynes.jl/blob/8c758de3c8d97da8d23c39f73e5b05028a1b3b5a/src/inference/pf.jl#L106-L112">source</a></section></article><p><code>resample!</code> can be applied to both instances of <code>Particles</code> produced by particle filtering, as well as instances of <code>Particles</code> produced by importance sampling.</p><h2 id="Markov-chain-Monte-Carlo"><a class="docs-heading-anchor" href="#Markov-chain-Monte-Carlo">Markov chain Monte Carlo</a><a id="Markov-chain-Monte-Carlo-1"></a><a class="docs-heading-anchor-permalink" href="#Markov-chain-Monte-Carlo" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="Jaynes.metropolis_hastings" href="#Jaynes.metropolis_hastings"><code>Jaynes.metropolis_hastings</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">call, accepted, metropolis_hastings(call::BlackBoxCallSite,
                                    sel::UnconstrainedSelection)</code></pre><p>Perform a Metropolis-Hastings step by proposing new choices using the prior at addressed specified by <code>sel</code>. Returns a call site, as well as a Boolean value <code>accepted</code> to indicate if the proposal was accepted or rejected.</p><pre><code class="language-julia">call, accepted = metropolis_hastings(call::BlackBoxCallSite,
                                     proposal::Function,
                                     proposal_args::Tuple,
                                     sel::UnconstrainedSelection)</code></pre><p>Perform a Metropolis-Hastings step by proposing new choices using a custom proposal at addressed specified by <code>sel</code>. Returns a call site, as well as a Boolean value <code>accepted</code> to indicate if the proposal was accepted or rejected.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/femtomc/Jaynes.jl/blob/8c758de3c8d97da8d23c39f73e5b05028a1b3b5a/src/inference/mh.jl#L33-L49">source</a></section></article><div class="admonition is-info"><header class="admonition-header">Info</header><div class="admonition-body"><p>Similar to custom proposals for particle filtering, a custom proposal passed to <code>metropolis_hastings</code> should accept an instance of <code>CallSite</code> as the first argument, followed by the other proposal arguments.</p><p>Additionally, if the proposal proposes to addresses which modify the control flow of the original call, it must also provide proposal choice sites for any addressed which exist on that branch of the original model. If this criterion is not satisfied, the kernel is not stationary with respect to the target posterior of the model.</p></div></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../selection_interface/">« Selection interface</a><a class="docs-footer-nextpage" href="../fmi/">Foreign model interface »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Sunday 12 July 2020 00:27">Sunday 12 July 2020</span>. Using Julia version 1.4.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
