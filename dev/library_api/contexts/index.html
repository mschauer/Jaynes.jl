<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Execution contexts · Jaynes.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="Jaynes.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit">Jaynes.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><a class="tocitem" href="../../concepts/">Concepts</a></li><li><a class="tocitem" href="../../modeling_lang/">Modeling language</a></li><li><a class="tocitem" href="../../examples/">Examples</a></li><li><a class="tocitem" href="../../architecture/">Architecture</a></li><li><span class="tocitem">Library</span><ul><li><a class="tocitem" href="../sites/">Traces, choices, and call sites</a></li><li class="is-active"><a class="tocitem" href>Execution contexts</a></li><li><a class="tocitem" href="../selection_interface/">Selection interface</a></li><li><input class="collapse-toggle" id="menuitem-6-4" type="checkbox"/><label class="tocitem" for="menuitem-6-4"><span class="docs-label">Inference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../inference/is/">Importance sampling</a></li><li><a class="tocitem" href="../../inference/mh/">Metropolis-Hastings</a></li><li><a class="tocitem" href="../../inference/pf/">Particle filtering</a></li><li><a class="tocitem" href="../../inference/vi/">Automatic differentiation variational inference</a></li></ul></li><li><a class="tocitem" href="../fmi/">Foreign model interface</a></li><li><a class="tocitem" href="../diff_prog/">Differentiable programming</a></li></ul></li><li><a class="tocitem" href="../../related_work/">Related work</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Library</a></li><li class="is-active"><a href>Execution contexts</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Execution contexts</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/femtomc/Jaynes.jl/blob/master/docs/src/library_api/contexts.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p>Here is a description of the set of &quot;standard&quot; contexts which are used frequently in modeling and inference. Gradient and foreign model contexts are discussed in <a href="../diff_prog/">Differentiable programming</a> and <a href="../fmi/">Foreign model interface</a>, respectively.</p><article class="docstring"><header><a class="docstring-binding" id="Jaynes.GenerateContext" href="#Jaynes.GenerateContext"><code>Jaynes.GenerateContext</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">mutable struct GenerateContext{T &lt;: Trace, K &lt;: ConstrainedSelection, P &lt;: Parameters} &lt;: ExecutionContext
     tr::T
     select::K
     weight::Float64
     score::Float64
     visited::Visitor
     params::P
end</code></pre><p><code>GenerateContext</code> is used to generate traces, as well as record and accumulate likelihood weights given observations at addressed randomness.</p><p>Inner constructors:</p><pre><code class="language-julia">GenerateContext(tr::T, select::K) where {T &lt;: Trace, K &lt;: ConstrainedSelection} = new{T, K}(tr, select, 0.0, Visitor(), Parameters())
GenerateContext(tr::T, select::K, params::P) where {T &lt;: Trace, K &lt;: ConstrainedSelection, P &lt;: Parameters} = new{T, K, P}(tr, select, 0.0, Visitor(), params)</code></pre><p>Outer constructors:</p><pre><code class="language-julia">Generate(select::ConstrainedSelection) = GenerateContext(Trace(), select)
Generate(select::ConstrainedSelection, params) = GenerateContext(Trace(), select, params)
Generate(tr::Trace, select::ConstrainedSelection) = GenerateContext(tr, select)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/femtomc/Jaynes.jl/blob/4a14d860e30c07839b76ca00554329d66f4ed847/src/contexts/generate.jl#L63-L87">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Jaynes.generate" href="#Jaynes.generate"><code>Jaynes.generate</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">ret, cl, w = generate(sel::L, fn::Function, args...; params = Parameters()) where L &lt;: ConstrainedSelection
ret, cs, w = generate(sel::L, fn::typeof(rand), d::Distribution{K}; params = Parameters()) where {L &lt;: ConstrainedSelection, K}
ret, v_cl, w = generate(sel::L, fn::typeof(markov), call::Function, len::Int, args...; params = Parameters()) where L &lt;: ConstrainedSelection
ret, v_cl, w = generate(sel::L, fn::typeof(plate), call::Function, args::Vector; params = Parameters()) where L &lt;: ConstrainedSelection
ret, v_cl, w = generate(sel::L, fn::typeof(plate), d::Distribution{K}, len::Int; params = Parameters()) where {L &lt;: ConstrainedSelection, K}</code></pre><p>The convenience <code>generate</code> function provides an easy API to the <code>Generate</code> context. You can use this function on any of the matching signatures above - it will return the return value <code>ret</code>, a <code>RecordSite</code> instance specialized to the call, and the score/weight <code>w</code> computed with respect to the constraints <code>sel</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/femtomc/Jaynes.jl/blob/4a14d860e30c07839b76ca00554329d66f4ed847/src/contexts/generate.jl#L90-L99">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Jaynes.SimulateContext" href="#Jaynes.SimulateContext"><code>Jaynes.SimulateContext</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">mutable struct SimulateContext{T &lt;: Trace} &lt;: ExecutionContext
    tr::T
    visited::Visitor
    params::LearnableParameters
    SimulateContext(params) where T &lt;: Trace = new{T}(Trace(), Visitor(), params)
end</code></pre><p><code>SimulateContext</code> is used to simulate traces without recording likelihood weights. <code>SimulateContext</code> can be instantiated with custom <code>LearnableParameters</code> instances, which is useful when used for gradient-based learning.</p><p>Inner constructors:</p><pre><code class="language-julia">SimulateContext(params) = new{HierarchicalTrace}(Trace(), Visitor(), params)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/femtomc/Jaynes.jl/blob/4a14d860e30c07839b76ca00554329d66f4ed847/src/contexts/simulate.jl#L61-L77">source</a></section></article><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>simulate</code>. Check Documenter&#39;s build log for details.</p></div></div><article class="docstring"><header><a class="docstring-binding" id="Jaynes.ProposeContext" href="#Jaynes.ProposeContext"><code>Jaynes.ProposeContext</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">mutable struct ProposeContext{T &lt;: Trace} &lt;: ExecutionContext
    tr::T
    weight::Float64
    score::Float64
    visited::Visitor
    params::LearnableParameters
end</code></pre><p><code>ProposeContext</code> is used to propose traces for inference algorithms which use custom proposals. <code>ProposeContext</code> instances can be passed sets of <code>LearnableParameters</code> to configure the propose with parameters which have been learned by differentiable programming.</p><p>Inner constructors:</p><pre><code class="language-julia">ProposeContext(tr::T) where T &lt;: Trace = new{T}(tr, 0.0, LearnableParameters())</code></pre><p>Outer constructors:</p><pre><code class="language-julia">Propose() = ProposeContext(Trace())</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/femtomc/Jaynes.jl/blob/4a14d860e30c07839b76ca00554329d66f4ed847/src/contexts/propose.jl#L57-L81">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Jaynes.propose" href="#Jaynes.propose"><code>Jaynes.propose</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">ret, g_cl, w = propose(fn::Function, args...)
ret, cs, w = propose(fn::typeof(rand), d::Distribution{K}) where K
ret, v_cl, w = propose(fn::typeof(markov), call::Function, len::Int, args...)
ret, v_cl, w = propose(fn::typeof(plate), call::Function, args::Vector)
ret, v_cl, w = propose(fn::typeof(plate), d::Distribution{K}, len::Int) where K</code></pre><p>The convenience <code>propose</code> function provides an easy API to the <code>Propose</code> context. You can use this function on any of the matching signatures above - it will return the return value <code>ret</code>, a <code>RecordSite</code> instance specialized to the call, and the score/weight <code>w</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/femtomc/Jaynes.jl/blob/4a14d860e30c07839b76ca00554329d66f4ed847/src/contexts/propose.jl#L84-L93">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Jaynes.ScoreContext" href="#Jaynes.ScoreContext"><code>Jaynes.ScoreContext</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">mutable struct ScoreContext{P &lt;: Parameters} &lt;: ExecutionContext
    select::ConstrainedSelection
    weight::Float64
    params::P
end</code></pre><p>The <code>ScoreContext</code> is used to score selections according to a model function. For computation in the <code>ScoreContext</code> to execute successfully, the <code>select</code> selection must provide a choice for every address visited in the model function, and the model function must allow the context to visit every constraints expressed in <code>select</code>.</p><p>Inner constructors:</p><pre><code class="language-julia">function Score(obs::Vector{Tuple{K, P}}) where {P, K &lt;: Union{Symbol, Pair}}
    c_sel = selection(obs)
    new{NoParameters}(c_sel, 0.0, Parameters())
end</code></pre><p>Outer constructors:</p><pre><code class="language-julia">ScoreContext(obs::K, params) where {K &lt;: ConstrainedSelection} = new(obs, 0.0, params)
Score(obs::Vector) = ScoreContext(selection(obs))
Score(obs::ConstrainedSelection) = ScoreContext(obs, Parameters())
Score(obs::ConstrainedSelection, params) = ScoreContext(obs, params)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/femtomc/Jaynes.jl/blob/4a14d860e30c07839b76ca00554329d66f4ed847/src/contexts/score.jl#L72-L100">source</a></section></article><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>score</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>UpdateContext</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>update</code>. Check Documenter&#39;s build log for details.</p></div></div><article class="docstring"><header><a class="docstring-binding" id="Jaynes.RegenerateContext" href="#Jaynes.RegenerateContext"><code>Jaynes.RegenerateContext</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">mutable struct RegenerateContext{T &lt;: Trace, 
                                 L &lt;: UnconstrainedSelection,
                                 P &lt;: Parameters} &lt;: ExecutionContext
    prev::T
    tr::T
    select::L
    weight::Float64
    score::Float64
    discard::T
    visited::Visitor
    params::P
end</code></pre><p>Inner constructors:</p><pre><code class="language-julia">function RegenerateContext(tr::T, sel::Vector{Address}) where T &lt;: Trace
    un_sel = selection(sel)
    new{T, typeof(un_sel), NoParameters}(tr, Trace(), un_sel, 0.0, Trace(), Visitor(), Parameters())
end
function RegenerateContext(tr::T, sel::L) where {T &lt;: Trace, L &lt;: UnconstrainedSelection}
    new{T, L, NoParameters}(tr, Trace(), sel, 0.0, Trace(), Visitor(), Parameters())
end</code></pre><p>Outer constructors:</p><pre><code class="language-julia">Regenerate(tr::Trace, sel::Vector{Address}) = RegenerateContext(tr, sel)
Regenerate(tr::Trace, sel::UnconstrainedSelection) = RegenerateContext(tr, sel)</code></pre><p>The <code>RegenerateContext</code> is used for MCMC algorithms, to propose new choices for addresses indicated by an <code>UnconstrainedSelection</code> in the <code>select</code> field.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/femtomc/Jaynes.jl/blob/4a14d860e30c07839b76ca00554329d66f4ed847/src/contexts/regenerate.jl#L68-L104">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Jaynes.regenerate" href="#Jaynes.regenerate"><code>Jaynes.regenerate</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">ret, call_site = regenerate(sel::L, bbcs::HierarchicalCallSite, new_args...) where L &lt;: UnconstrainedSelection
ret, call_site = regenerate(sel::L, bbcs::HierarchicalCallSite) where L &lt;: UnconstrainedSelection</code></pre><p>Users will likely interact with the <code>RegenerateContext</code> through the convenience method <code>regenerate</code> which requires that users provide an <code>UnconstrainedSelection</code>, an original call site, and possibly a set of new arguments to be used in the regeneration step. This context internally keeps track of the bookkeeping required to increment likelihood weights, as well as prune off parts of the trace which are invalid if a regenerated choice changes the shape of the trace (e.g. control flow).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/femtomc/Jaynes.jl/blob/4a14d860e30c07839b76ca00554329d66f4ed847/src/contexts/regenerate.jl#L107-L113">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../sites/">« Traces, choices, and call sites</a><a class="docs-footer-nextpage" href="../selection_interface/">Selection interface »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Saturday 18 July 2020 21:18">Saturday 18 July 2020</span>. Using Julia version 1.4.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
